rules:
  - apiGroups: [""]
    apiVersions: ["v1"]
    resources: ["services"]
    operations: ["CREATE", "UPDATE"]
mutating: false
contextAware: false
annotations:
  io.kubewarden.policy.title: disallow-service-nodeport
  io.kubewarden.policy.description: Prevent the creation of Service resources of type `NodePort`
  io.kubewarden.policy.author: Flavio Castelli
  io.kubewarden.policy.url: https://github.com/kubewarden/disallow-service-nodeport
  io.kubewarden.policy.source: https://github.com/kubewarden/disallow-service-nodeport
  io.kubewarden.policy.license: Apache-2.0
  io.kubewarden.policy.usage: |
    This policy works by inspecting `type` of `Service` resources.

    Services with type `NodePort` are not allowed. Kubernetes network policies
    have no control over what is being exposed via these type of Services.
